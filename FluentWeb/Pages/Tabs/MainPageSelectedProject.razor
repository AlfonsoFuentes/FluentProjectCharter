@using Web.Infrastructure.Managers.Projects
<FluentGrid Justify="JustifyContent.SpaceEvenly">
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentStack Orientation="Orientation.Vertical">
                    <FluentLabel><strong>Start</strong></FluentLabel>
                </FluentStack>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Plannification</strong></FluentLabel>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Execution</strong></FluentLabel>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Monitoring / Control</strong></FluentLabel>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Closing</strong></FluentLabel>

            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <IconButton IconEnd="@(new Icons.Regular.Size20.DocumentPdf())" OnClick="@ExportProjectCharter" ToolTip="Generate Project Charter PDF"></IconButton>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <IconButton IconEnd="@(new Icons.Regular.Size20.DocumentPdf())" OnClick="@ExportProjectExecution" ToolTip="Generate Project Execution PDF"></IconButton>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">


            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">


            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">


            </FluentGridItem>
        </FluentGrid>
    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Stakeholder Management</strong></FluentLabel>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2" Gap="@gap">
                <FluentAnchor Href="@($"StakeHolderInsideProjects/{Project.Id}")" Appearance="Appearance.Hypertext">StakeHolders</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2" Gap="@gap">
                <FluentAnchor Href="@($"StakeHolderInsideProjects/{Project.Id}")" Appearance="Appearance.Hypertext">StakeHolders</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Scope Management</strong></FluentLabel>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentGrid Spacing="0" AdaptiveRendering="true">
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"BackGrounds/{Project.Id}")" Appearance="Appearance.Hypertext">Backgrounds</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Objectives/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Objectives</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Requirements/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Requirements</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Scopes/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Scopes</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Bennefits/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Bennefits</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"AcceptanceCriterias/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Acceptance Criterias</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Constrainsts/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Constrainsts</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Assumptions/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Assumptions</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"LearnedLessons/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Learned Lessons</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"ExpertJudgements/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Expert Judgements</FluentAnchor>
                    </FluentGridItem>
                </FluentGrid>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentGrid Spacing="0" AdaptiveRendering="true">
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Appearance="Appearance.Hypertext"></FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Objectives/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Objectives</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Requirements/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Requirements</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Scopes/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Scopes</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Bennefits/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Bennefits</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"AcceptanceCriterias/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Acceptance Criterias</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Constrainsts/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Constrainsts</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Assumptions/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Assumptions</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"LearnedLessons/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Learned Lessons</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"ExpertJudgements/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Expert Judgements</FluentAnchor>
                    </FluentGridItem>
                </FluentGrid>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Timeline Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentGrid Spacing="0" AdaptiveRendering="true">
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Deliverables/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Deliverables</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">

                    </FluentGridItem>
                </FluentGrid>

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentGrid Spacing="0" AdaptiveRendering="true">
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Deliverables/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Deliverables</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentAnchor Href="@($"Milestones/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Milestones</FluentAnchor>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentLabel>Work breakdown structure</FluentLabel>
                    </FluentGridItem>
                    <FluentGridItem xs="12" sm="12" Gap="@gap">
                        <FluentLabel>Timeline</FluentLabel>
                    </FluentGridItem>
                </FluentGrid>


            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Budget Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"BudgetItems/{Project.Id}")" Appearance="Appearance.Hypertext">Budget Items</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Quality Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Qualitys/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Quality</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Qualitys/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Quality</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Risk Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"KnownRisks/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Know Risks</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"KnownRisks/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Risks</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Resources Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Resources/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Resources</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Resources/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Resources</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Communication Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">

            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Communications/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Communications</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
    <FluentGridItem xs="12" sm="12" Style="border:solid 1px lightgray">
        <FluentGrid Spacing="0" AdaptiveRendering="true">
            <FluentGridItem xs="12" sm="2">
                <FluentLabel><strong>Acquisiton Management</strong></FluentLabel>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Acquisitions/{Project.Id}/{Project.StartId}/{"Start"}")" Appearance="Appearance.Hypertext">Acquisitons</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
                <FluentAnchor Href="@($"Acquisitions/{Project.Id}/{Project.PlanningId}/{"Planning"}")" Appearance="Appearance.Hypertext">Acquisitons</FluentAnchor>
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
            <FluentGridItem xs="12" sm="2">
            </FluentGridItem>
        </FluentGrid>

    </FluentGridItem>
</FluentGrid>

@code {
    [Parameter]
    public ProjectResponse Project { get; set; } = null!;
    string gap = "1px";
    [Inject]
    private IProjectService ProjectService { get; set; } = null!;

    public async Task ExportProjectCharter()
    {

        var resultExport = await ProjectService.ExportProjectCharter(Project);
       if (resultExport.Succeeded)
       {

           Console.WriteLine(resultExport.Message);
           var downloadresult = await blazorDownloadFileService.DownloadFile(resultExport.Data.ExportFileName,
             resultExport.Data.Data, contentType: resultExport.Data.ContentType);
           if (downloadresult.Succeeded)
           {
                _snackBar.ShowSuccess($"Project Charter for {Project.Name} exported succesfully");

           }
           else
           {
                _snackBar.ShowError($"Project Charter for {Project.Name} not exported succesfully");
           }
       }
       else
       {
            _snackBar.ShowError($"Project Charter for {Project.Name} not created succesfully");
       }
    }
    public async Task ExportProjectExecution()
    {

        var resultExport = await ProjectService.ExportProjectPlann(Project);
        if (resultExport.Succeeded)
        {

            Console.WriteLine(resultExport.Message);
            var downloadresult = await blazorDownloadFileService.DownloadFile(resultExport.Data.ExportFileName,
              resultExport.Data.Data, contentType: resultExport.Data.ContentType);
            if (downloadresult.Succeeded)
            {
                _snackBar.ShowSuccess($"Project Charter for {Project.Name} exported succesfully");

            }
            else
            {
                _snackBar.ShowError($"Project Charter for {Project.Name} not exported succesfully");
            }
        }
        else
        {
            _snackBar.ShowError($"Project Charter for {Project.Name} not created succesfully");
        }
    }
}
